<!DOCTYPE html>
<html>

<head>
  <link rel="stylesheet" type="text/css" href="index.css">
</head>

<body>
  <div id="top-half">
    <div id="button-container">
      <button id="split-button">Split</button>
      <button id="reset-button">Reset</button>
    </div>
  </div>
  <div id="button-container">
    <button id="back-button">Back</button>
    <button id="forward-button">Forward</button>
  </div>

  <div id="json-container"></div>

  <script>
    const { ipcRenderer } = require('electron');
    const { splitButtonClickedEvent } = require('./ui/eventHandler.js');
    const DomHandler = require('./ui/domHandler.js');
    const domHandler = new DomHandler(document);



    let filterWords = [];

    const backButton = document.getElementById('back-button');
    backButton.addEventListener('click', () => {
      ipcRenderer.send('back-button-clicked');
    });

    const forwardButton = document.getElementById('forward-button');
    forwardButton.addEventListener('click', () => {
      ipcRenderer.send('forward-button-clicked');
    });

    document.getElementById('split-button').addEventListener('click', () => {
      splitButtonClickedEvent(window.getSelection(), filterWords, ipcRenderer)
    }
    );

    ipcRenderer.send('get-json-data');

    ipcRenderer.on('json-data', (event, data) => {

      const filteredObjects = data.filteredObjects;
      const targetWord = data.currentWord;
      filterWords = filteredObjects.map(obj => obj.filterWord);

      domHandler.createTargetWordDiv(targetWord);

      const jsonContainer = document.getElementById('json-container');
        while (jsonContainer.firstChild) {
            jsonContainer.removeChild(jsonContainer.firstChild);
          }
      
      filteredObjects.forEach((filteredObject, index) => {
        domHandler.createFilteredListDisplay(filteredObject);
      });
    });
  </script>
</body>

</html>